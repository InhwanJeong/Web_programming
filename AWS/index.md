AWS(Amazon Web Service)
===

## 0. 개요
- aws(아마존 웹 서비스)
- 글로벌 인프라
  - 세계 13개국에 서비스를 운영 중이며 엣지 로케이션으로 원활한 서비스 제공

## 1. AWS 기초서비스

#### Amazon EC2(Amazon Elastic Compute Cloud)
  - 사용한 용량만큼 값을 지불
  - 리눅스 또는 윈도우 선택
  - 안정성을 위해 여러 AWS 리전과 가용 영역을 걸쳐 배포
  - 태그를 사용하여 리소스 관리

- 인스턴스 수명주기
  - pending : 가용가능한 서버를 찾는 과정
  - running : 서버이용 및 과금 지불
  - stopped : 이용중단 및 과금 중단

- 인스턴스 선택시 고려사항
  - 코어 수
  - 메모리 크기
  - 스토리지 크기 및 유형
  - 네트워크 성능
  - cpu 기술

- 인스턴스 메타데이터 및 사용자 데이터
  - 인스턴스에 대한 데이터(IP주소)

- EC2의 구입(과금)) 옵션
  - 온 디맨드 인스턴스 : 시간당 비용 지불(리눅스는 초당 과금가능)
  - 예약 인스턴스 : 특정기간 사용가능(1년 or 3년), 최대75% 할인
  - 예정된 인스턴스 : 1년 단위로 예정된 일정에만 사용가능
  - 스팟 인스턴스 : 사용가능한 인스턴스를 입찰 방식으로 사용가능
  - 전용 인스턴스 :  특정 인스턴스를 대여
  - 전용 호스트 : 특정 서버를 통채로 대여(라이선스 문제를 해결하기 위해 사용, 하드웨어에 대한 가시성이 필요할 떄)
  - 보통 섞어 사용하는 것이 일반적이다.

## 2. Amazon VPC (virtual private cloud)
- virtual private cloud : aws 클라우드에서 격리된 가상네트워크, 가상 네트워크 환경을 완벽하게 제어가능

#### 2.1 vpc 및 서브넷
- 서브넷은 vpc 내 ip주소 범위를 정의한다.
- private 서브넷은 인터넷으로 엑세스가 불가능한 리소스 사용
- public 서브넷은 인터넷으로 엑세스 가능한 리소스 사용
- 각 서브넷은 하나의 가용 영역에 상주해야하며 다른영역으로 확장 (X)

#### 2.2 vpc 예
- AWS cloud -> vpc -> subnet
  - 퍼블릭 서브넷 : 웹서버, vpc nat게이트웨이
  - 프라이빗 서브넷 : 애플리케이션 서버
  - vpn 전용 서브넷 : DB서버

#### 2.3 vpc의 보안
- 인스턴스 <-> 보안그룹 <-> 서브넷 <-> 네트워크 ACL <->  라우팅테이블 <-> vpc 라우터 <-> vpn 게이트웨이
- 1차 네트워크 ACL방화벽, 2차 보안그룹

## 실습
- 1. vpc 생성
  - 퍼블릭 서브넷 2개
  - 프라이빗 서브넷 2개
- 2. 애플리케이션 서버 생성
  - 보안그룹생성
  - 인스턴스 시작

#### 구축과정
- vpc 생성 : 퍼블릭 서브넷 1개, 프라이빗 서브넷 1개 생성
- 추가 서브넷 생성 : 추가 서브넷(각 1개) 생성
- vpc 보안그룹 생성
- 첫번째 웹 인스턴스(EC2) 시작


!스토리지!
--------------------------------

## 3. Amazon S3(Simple Storage Service)
- 파일 전체단위로 운용
- 인터넷용 스토리지
- 기본적으로 온라인, HTTP기반 엑세스
- 웹읉통해 어디서든 원하는 양의 데이터를 저장하고 검색 가능
- 고도의 확장성, 안전성, 속도 및 내구성
#### 3.1 S3에 대한 정보
- 버킷에 저장가능한 객체 수에는 제한이 없다.
- 객체의 최대크기는 5TB이다.
- 최대 100개의 버킷 사용가능
- 버전관리 시스템을 지원

#### 3.2 일반적인 시나리오
- 스토리지 및 백업 용도
- 애플리케이션 파일 호스팅
- 미디어 호스팅
- 소프트웨어 전송
- AMI 및 스냅샷 저장

#### 3.3 Amazon Glacier
- 저렴한 장기 아카이빙 서비스
- 검색에 3~5시간 소요
- 자주 엑세스하지 않는 데이터에 최적(다운 비용이 비쌈)



## 4. Amazon EBS(Elastic Block Store)
- 블럭단위로 운용
- EBS 볼륨 유형
  - SSD 지원 볼륨
  - HDD 지원 볼륨

#### EBS에 대한 정보
- 데이터에 빠르게 엑세스하고 장기간 지속해야할 때 유용
- 암호화된 볼륨으로 시작해 모든 내용을 암호화한다.


구분 | EBS | S3
--- | --- | ---
패러다임 | 블록스토리지 | 객채스토리지
성능 | 매우빠름 | 빠름
중복성 | 서버에 걸쳐있음 | 리전 내 여러 시설에 있음
보안 | 암호화 | 암호화
인터넷 엑세스 여부 | 불가능 | 가능
일반적인 사용 | 디스크 드라이브 | 온라인 스토리지


#### EC2 인스턴스 스토리지
- 휘발성 스토리지(재부팅, 중단, 종료시)

!보안, 자격증명 및 엑세스!
-----------------------------
## AWS 공동 책임 모델
- Amazon
  - 기초서비스(컴퓨팅, 스토리지, 데이터베이스, 네트워킹)
  - 글로벌인프라(가용 영역, 지역, 엣지 로케이션)
  - 물리적 보안
  - 네트워크, 하드웨어 보안
    - 자동 변경 제어 프로세스
    - 모든 접속 시도를 기록하는 베스천 서버
    - 방화벽과 모니터링
- client
  - 클라이언트 및 서버 측 데이터 암호화
  - 네트워크 트래픽 보호
  - 운영체제 및 네트워크 방화벽 구성
  - 플랫폼, 애플리케이 자격증명 및 엑세스 관리

## 5. AWS IAM (Identity and Access Management)
- 아마존 계정 생성시 IAM에서 높은 권한의 계정을 만들어 사용하며 최대한 루트계정 사용을 안하는 것이 좋다.
- 인증
  - AWS Management Console
  - AWS CLI 또는 SDK API
- 특정 그룹단위로 계정을 관리
  - 사용자의 모음이다.
  - 기본 그룹은 없다.
  - 그룹은 중첩될 수 없다.
  - 권한은 IAM정책을 사용한다.
  - 가능한 빨리 루트계정 사용을 중단하는 것이 좋다.


#### AWS CloudTrail
- 모든 정보를 로그파일로 저장하여 S3 버킷에 저장

!데이터 베이스!
----------------------------
## SQL 및 NoSQL

#### AWS 관리형 데이터베이스 서비스
- Amazon DynamoDB
  - 완전관리형 NoSQL
  - SSD에서만 실행가능
  - 모바일, 웹, 게임, 광고, IOT기술에 적합

- Amazon RDS(Relational Database Service) : 관계형 데이터베이스
  - 관리형 서비스
  - 확장 가능
  - 자동화된 중복성 및 백업 지원
  - 필요(사용) 시기
    - 복잡한 트랜잭션 또는 쿼리
    - 높은 내구성
    - 단일 작업자 노드/샤드를 사용

## 실습 vpc와 RDS
- 1. DB 보안그룹 생성 및 웹과 연동
- 2. DB 서브넷 그룹 생성
- 3. RDS DB 인스턴스 생성
- 4. 데이터베이스와 상호작용

!AWS 탄력성과 관리도구!
------------------------

#### Elastic Load Balancing
- 인스턴스에 걸쳐 트래픽을 분산
- 비정상 인스턴스를 감지하기 위한 상태확인 지원
- Amazon EC2 인스턴스에 대한 HTTP, HTTPS, SSL 및 TCP 트래픽의 라우팅과 로드 밸런싱 지원

#### cloud Watching
- AWS에서 실행하는 리소스와 애플리케이션에 대한 모니터링 서비스
- 리소스 사용률, 운영 성능 및 전체 수요 패턴에 대한 가시성
-

#### AUTO Scaling
- 애플리케이션의 가용성을 보다 쉽게 관리가 가능
- Amazon EC2 용량을 자동으로 조정
- 사용량의 변화가 많은 애플리케이션에 매우 적합
- 추가요금 없이 사용
- 내결함성 향상, 가용성 항상, 비용관리 개선


## 실습 아키텍처를 확장 및 로드 밸런싱
- 1. Auto Scaling 용 AMI생성
- 2. 로드 밸런서 생성
- 3. 시작 구성 및 Auto Scaling그룹 생성
- 4. Auto Scaling 작동 확인
- 5. Auto Scaling 테스트
